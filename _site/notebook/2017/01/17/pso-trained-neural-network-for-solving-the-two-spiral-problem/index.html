<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>PSO Neural Network</title>
  <meta name="description" content="This is a simple implementation of a 2-16-1 neural network trained using Particle Swarm Optimization in order to solve the two-spiral problem. The and activa...">

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="http://localhost:4000/notebook/2017/01/17/pso-trained-neural-network-for-solving-the-two-spiral-problem/">
  <link rel="alternate" type="application/rss+xml" title="Lj Miranda" href="/feed.xml">
  <link rel="icon" type="image/png" href="/assets/favicon.ico">
  
  
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
   

  

  <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>PSO Neural Network | Lj Miranda</title>
<meta property="og:title" content="PSO Neural Network" />
<meta name="author" content="LJ MIRANDA" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Trained a neural network using particle swarm optimization (PSO) to solve the two-spiral problem" />
<meta property="og:description" content="Trained a neural network using particle swarm optimization (PSO) to solve the two-spiral problem" />
<link rel="canonical" href="http://localhost:4000/notebook/2017/01/17/pso-trained-neural-network-for-solving-the-two-spiral-problem/" />
<meta property="og:url" content="http://localhost:4000/notebook/2017/01/17/pso-trained-neural-network-for-solving-the-two-spiral-problem/" />
<meta property="og:site_name" content="Lj Miranda" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-01-17T00:00:00+09:00" />
<script type="application/ld+json">
{"name":null,"description":"Trained a neural network using particle swarm optimization (PSO) to solve the two-spiral problem","url":"http://localhost:4000/notebook/2017/01/17/pso-trained-neural-network-for-solving-the-two-spiral-problem/","headline":"PSO Neural Network","dateModified":"2017-01-17T00:00:00+09:00","datePublished":"2017-01-17T00:00:00+09:00","sameAs":null,"@type":"BlogPosting","author":{"@type":"Person","name":"LJ MIRANDA"},"image":null,"publisher":null,"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/notebook/2017/01/17/pso-trained-neural-network-for-solving-the-two-spiral-problem/"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">
    <a class="site-title" href="/">Lj Miranda</a>
  
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
            <a class="page-link" href="/downloads/LMiranda.pdf">CV</a>
            <a class="page-link" href="/research/">Research</a>
            <a class="page-link" href="/projects/">Projects</a>
            <a class="page-link" href="/notebook/">Notebook</a>
        </div>
      </nav>
  </div>
</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">PSO Neural Network</h1>
    <p class="post-meta">
      <time datetime="2017-01-17T00:00:00+09:00" itemprop="datePublished">
        
        Jan 17, 2017
      </time>
      
        • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">LJ MIRANDA</span></span>
      </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>This is a simple implementation of a 2-16-1 neural network trained using Particle Swarm Optimization in order to solve the two-spiral problem. The <script type="math/tex">\sin(z)</script> and <script type="math/tex">\sigma(z)</script> activation functions were used for the input-hidden and hidden-output layers respectively. The cross-entropy error was used as the cost function<!--more-->
. The two-spiral problem is a particularly difficult problem that requires separating two logistic spirals from one another.</p>

<p style="text-align: center;"><img src="http://i.imgur.com/AB14SHCl.png" alt="Two Spiral Problem" /><br />
<strong>Figure 1:</strong> <em>Graph of the Two-Spiral Problem</em></p>

<h2 id="particle-swarm-optimization">Particle Swarm Optimization</h2>
<p>Particle swarm optimization is a population-based search algorithm that is based on the social behavior of birds within a
flock. In PSO, the particles are scattered throughout the hyperdimensional search space. These particles use the results found
by the others in order to build a better solution.</p>

<h2 id="methodology">Methodology</h2>
<p>For Particle Swarm Optimization, we first initialize the swarm, and then observe the effects of the social and cognitive parameters
to its performance. After that, parameter tuning will be implemented as the neural network will be cross-validated with respect
to the social and cognitive parameters.</p>

<h3 id="initialization">Initialization</h3>
<p>For any particle <script type="math/tex">n = 1,2, \dots , N</script>, its position <script type="math/tex">P</script> at time-step <script type="math/tex">t</script> with respect to the ANN parameters are expressed as:</p>

<script type="math/tex; mode=display">% <![CDATA[
P_{n,t} \equiv \begin{bmatrix}
\Theta_{11}^{(1)} & \Theta_{12}^{(1)} & \dots & \Theta_{ij}^{(1)}\\
\Theta_{11}^{(2)} & \Theta_{21}^{(2)} & \dots & \Theta_{jk}^{(2)}
\end{bmatrix} %]]></script>

<p>The particle matrix <strong>P</strong> was initialized using uniform distribution. This is to maximize the exploration capability of the particles
over the search space by distributing it evenly. Using a gaussian distribution to initialize the particles will “scatter” it in a centered weight
, reducing the exploration capacity.</p>

<h3 id="implementation-parameters">Implementation Parameters</h3>

<table class="table">
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">maxIter</code></td>
      <td>Number of iterations that the PSO algorithm will run</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">swarmSize</code></td>
      <td>Number of particles in the search space.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">epsilon</code></td>
      <td>Scattering degree of the particles during initialization</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">c_1</code></td>
      <td>Cognitive component (exploration parameter).</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">c_2</code></td>
      <td>Social component (exploitation parameter).</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">inertiaWeight</code></td>
      <td>Inertia weight that controls the movement of particles.</td>
    </tr>
  </tbody>
</table>
<p style="text-align: center;"><strong>Table 1:</strong> <em>Parameters used in PSO Implementation</em></p>

<h3 id="tuning-the-social-and-cognitive-behaviour-of-the-swarm">Tuning the social and cognitive behaviour of the swarm</h3>
<p>Here, I swept over different values for the social and cognitive components, and came up with this matrix:</p>

<p style="text-align: center;"><img src="/assets/png/nn/cmatrix.png" alt="Cmatrix for PSO params" width="320px" />  <br />
<strong>Figure 2:</strong> <em>Heat map for testing the social and cognitive parameters</em></p>

<p>From this value matrix, it is clear that accuracy may improve with values where the ratio of <script type="math/tex">c_{1}</script> and <script type="math/tex">c_{2}</script> is
<script type="math/tex">\approx 1</script>. Moreover, it also shows that setting a very low cognitive value doesn’t improve the solution.
However, because the value matrix doesn’t give anything definitive regarding the settings for <script type="math/tex">c_{1}</script> and <script type="math/tex">c_{2}</script>,
a more heuristic approach is applied.</p>

<h3 id="observation-of-swarm-behavior">Observation of Swarm Behavior</h3>
<p>The following images below show the simulation of the swarm (only at parameters <script type="math/tex">\theta_{11}^{(1)}</script> and
<script type="math/tex">\theta_{12}^{(1)}</script>) given different values of the social and cognitive components. Below these simulations,
a graph of the cost is traced. One can then see the differences in their behavior by looking on the
convergence of the “mean best” with respect to the personal and global bests.</p>

<p style="text-align: center;"><img src="/assets/png/nn/pso_r_test1_zeroc1.gif" alt="PSO Run for c1" height="250px" width="320px" /> <img src="/assets/png/nn/pso_r_test2_zeroc2.gif" alt="PSO Run c2" height="250px" width="320px" /><br />
<strong>Figure 2:</strong> <em>Swarm behavior at when it is fully social (left) and fully cognitive (right)</em></p>

<p style="text-align: center;"><img src="/assets/png/nn/pso_r_test1_zeroc1.png" alt="PSO Run for c1" height="250px" width="320px" /> <img src="/assets/png/nn/pso_r_test2_zeroc2.png" alt="PSO Run c2" height="250px" width="320px" /><br />
<strong>Figure 3:</strong> <em>Graph of the cost per iteration</em></p>

<p>For a swarm that has no cognitive parameter, the particles tend to move to the global best quite early, resulting to a
curve that converges easily. On the other hand, for a swarm that has no social parameter, the particles tend to move only
to their personal bests, without doing an effort to reach the best score found by the whole swarm.</p>

<h2 id="results">Results</h2>
<p>The best score that was achieved using this optimization algorithm is 85.5264% recall. The figure below shows the generalization ability that the algorithm can attain. Moreover, the table below shows the values I set for the parameters.</p>

<table class="table">
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">maxIter</code></td>
      <td>200</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">swarmSize</code></td>
      <td>50</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">epsilon</code></td>
      <td>0.1</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">c_1</code></td>
      <td>1.5</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">c_2</code></td>
      <td>0.9</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">inertiaWeight</code></td>
      <td>0.7</td>
    </tr>
  </tbody>
</table>
<p style="text-align: center;"><strong>Table 2:</strong> <em>Parameter values for PSO Implementation</em></p>

<p style="text-align: center;"><img src="http://i.imgur.com/JtMGhr8l.png" alt="Generalization ability of PSO" width="640px" />    <br />
<strong>Figure 4:</strong> <em>Generalization ability of the PSO-trained Neural Network over the whole space</em></p>

<h2 id="conclusion">Conclusion</h2>
<p>One of the main advantage of PSO is that there are only (at a minimum) two parameters to control. Balancing the tradeoff between exploitation and exploration is much easier as compared to other algorithms because it is much more intuitive. However, initialization is also important in PSO. It matters how the particles are distributed along the search space as it may increase or decrease their chances of finding the optimal solution. In this implementation, a small value of <script type="math/tex">0.1</script> was used for the spread parameter <script type="math/tex">\epsilon</script>.</p>

<p>Compared with the benchmark solution, the PSO has a tendency to run slower. Moreover, as the number of particles increase,
the computational time increases because the size of the matrices to be computed also expands. This problem may be solved
using advanced vectorization techniques in MATLAB, but overall, the PSO runtime often correlates with the swarm size.</p>

<h2 id="references">References</h2>
<ul>
  <li>A. Engelbrecht, <em>Computational Intelligence: An Introduction</em>, John Wiley &amp; Sons, Ltd., 2007.</li>
  <li>J.M. Sopena, E. Romero,R. Alquezar, “Neural networks with periodic and monotonic activation functions: a comparative study in classification problems,” <em>ICANN Ninth International Conference on Artificial Neural Networks</em>, 1999.</li>
  <li>K.J. Lang and M.J. Witbrock, “Learning to Tell Two Spirals Apart”, in: <em>Proceedings of the 1988 Connectionist Models Summer School</em>, Morgan Kauffman, 1998.</li>
  <li><a href="http://www.ibiblio.org/pub/academic/computer-science/neural-networks/programs/bench/two-spirals">Two-Spirals in Neural Networks</a>, [Accessed: 17 January 2017].</li>
</ul>

<p>You can access the gist <a href="https://gist.github.com/ljvmiranda921/53939299b9e67f0df082e0127c7f229d">here.</a></p>

  </div>

  
    

  
</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Lj Miranda</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
            
              Lj Miranda
            
            </li>
            
            <li><a href="mailto:ljvmiranda@gmail.com">ljvmiranda@gmail.com</a></li>
            
        </ul>
      </div>

      <div class="footer-col footer-col-2">
          <ul class="social-media-list">
    
    
    
    <li><a href="https://github.com/ljvmiranda921"><svg class="svg-icon"><use xlink:href="/assets/icons.svg#github"></use></svg> <span class="username">Github</span></a></li>
    
    <li><a href="https://www.linkedin.com/in/lesterjamesmiranda"><svg class="svg-icon"><use xlink:href="/assets/icons.svg#linkedin"></use></svg> <span class="username">Linkedin</span></a></li>
    
    
    
    
    <li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/icons.svg#rss"></use></svg> <span>RSS</span></a></li>
</ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Some notes on software development, data science, machine learning, and research.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
